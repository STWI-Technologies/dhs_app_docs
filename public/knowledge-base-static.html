<!DOCTYPE html>
<html lang="en" id="htmlElement">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direct Home Service - Knowledge Base</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <meta name="title-en" content="Direct Home Service - Knowledge Base">
    <meta name="title-es" content="Direct Home Service - Base de Conocimientos">
    <meta name="description" content="Customer Service Knowledge Base for Direct Home Service">
    <meta name="description-en" content="Customer Service Knowledge Base for Direct Home Service">
    <meta name="description-es" content="Base de Conocimientos de Atención al Cliente para Direct Home Service">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .language-switcher {
            position: fixed;
            bottom: 0;
            left: 25%;
            transform: translateX(-50%);
            z-index: 1000;
            background: #2d2d2d;
            padding: 10px 20px;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            font-size: 14px;
            font-weight: normal;
            min-width: 120px;
        }
        
        .language-switcher:hover {
            background: #3d3d3d;
        }
        
        .language-switcher.selecting {
            background: #2d2d2d;
        }

        .language-dropdown {
            display: none;
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: #2d2d2d;
            border-radius: 8px 8px 0 0;
            overflow: hidden;
        }

        .language-dropdown.show {
            display: block;
        }
        
        .language-current {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .language-current.hidden {
            display: none;
        }

        .language-option {
            padding: 10px 20px;
            background: transparent;
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            font-weight: normal;
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            text-align: left;
        }

        .language-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .flag {
            width: 20px;
            height: 14px;
            border-radius: 2px;
            display: inline-block;
            flex-shrink: 0;
        }

        .flag-us {
            background: linear-gradient(to bottom, #b22234 0%, #b22234 7.7%, #fff 7.7%, #fff 15.4%, #b22234 15.4%, #b22234 23.1%, #fff 23.1%, #fff 30.8%, #b22234 30.8%, #b22234 38.5%, #fff 38.5%, #fff 46.2%, #b22234 46.2%, #b22234 53.8%, #fff 53.8%, #fff 61.5%, #b22234 61.5%, #b22234 69.2%, #fff 69.2%, #fff 76.9%, #b22234 76.9%, #b22234 84.6%, #fff 84.6%, #fff 92.3%, #b22234 92.3%, #b22234 100%);
            position: relative;
        }

        .flag-us::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 40%;
            height: 53.8%;
            background: #3c3b6e;
        }

        .flag-es {
            background: linear-gradient(to bottom, #c60b1e 0%, #c60b1e 25%, #ffc400 25%, #ffc400 75%, #c60b1e 75%, #c60b1e 100%);
        }

        header {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px 20px;
            background: #f0f2f8;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
        }

        .logo {
            height: 60px;
            cursor: pointer;
            transition: transform 0.3s ease;
            display: block;
            margin: 0 auto;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .header-text {
            text-align: left;
        }

        .header-text h1 {
            margin-bottom: 5px;
        }

        h1 {
            color: #2E3192;
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #878787;
            font-size: 18px;
            font-weight: 300;
        }

        .search-container {
            margin: 30px 0;
            text-align: center;
        }

        .search-box {
            width: 100%;
            max-width: 600px;
            padding: 15px 25px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 50px;
            outline: none;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        .search-box:focus {
            border-color: #2E3192;
            box-shadow: 0 0 0 3px rgba(46, 49, 146, 0.1);
        }

        /* Enhanced search container for new functionality */
        .enhanced-search-container {
            margin: 30px auto;
            max-width: 800px;
        }

        .search-tabs {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        .search-tab {
            padding: 8px 16px;
            border: 1px solid #e0e0e0;
            background: white;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
            border-radius: 20px;
        }

        .search-tab.active {
            background: #2E3192;
            color: white;
            border-color: #2E3192;
        }

        .search-tab:hover:not(.active) {
            border-color: #2E3192;
            color: #2E3192;
        }

        .search-mode-container {
            display: none;
        }

        .search-mode-container.active {
            display: block;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .category-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .category-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .category-title {
            color: #2E3192;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-icon {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        .article-list {
            list-style: none;
        }

        .article-list li {
            margin-bottom: 12px;
        }

        .article-link {
            color: #555;
            text-decoration: none;
            font-size: 15px;
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .article-link:hover {
            background: #f8f9fa;
            color: #2E3192;
            padding-left: 15px;
        }

        .article-link::before {
            content: "→";
            margin-right: 10px;
            color: #96FAC2;
            font-weight: bold;
        }

        .quick-links {
            margin-top: 40px;
            padding: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        .quick-links-title {
            color: #2E3192;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .quick-links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .quick-link-btn {
            display: inline-block;
            padding: 12px 20px;
            background: linear-gradient(135deg, #2E3192 0%, #5158bb 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .quick-link-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 49, 146, 0.3);
        }

        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #878787;
            font-size: 14px;
        }

        /* Loading spinner for language detection */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(245, 247, 250, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e0e0e0;
            border-top: 4px solid #2E3192;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 768px) {
            .language-switcher {
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                padding: 10px 15px;
            }
            
            .language-switcher:hover {
                transform: translateX(-50%) translateY(-2px);
            }

            .language-btn {
                padding: 6px 12px;
                font-size: 12px;
            }

            .logo-container {
                flex-direction: column;
                gap: 15px;
            }

            .header-text {
                text-align: center;
            }

            h1 {
                font-size: 32px;
            }
            
            .categories-grid {
                grid-template-columns: 1fr;
            }

            .quick-links-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Loading overlay for language detection -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <!-- Language switcher -->
    <div class="language-switcher" id="languageSwitcher">
        <div class="language-current" id="languageCurrent">
            <span class="flag flag-us" id="currentFlag"></span>
            <span id="currentLang">English</span>
        </div>
        <div class="language-dropdown" id="languageDropdown">
            <button class="language-option" data-language="en">
                <span class="flag flag-us"></span>
                English
            </button>
            <button class="language-option" data-language="es">
                <span class="flag flag-es"></span>
                Español
            </button>
        </div>
    </div>

    <div class="container" id="mainContent">
        <header>
            <div class="logo-container">
                <a href="/index.html">
                    <img src="/brand/logo-12.png" alt="Direct Home Service" class="logo">
                </a>
                <p class="subtitle" id="subtitle" style="text-align: center; margin-top: 8px; font-size: 16px; color: #2E3192; font-weight: 500;">Customer Service Knowledge Base</p>
            </div>
        </header>

        <div class="enhanced-search-container">

            <!-- Local Search Mode -->
            <div class="search-mode-container active" id="localSearchMode">
                <div id="localSearchContainer"></div>
                <div id="localSearchResults"></div>
            </div>

        </div>

        <div class="categories-grid">
            <!-- Core Operations -->
            <div class="category-section">
                <h2 class="category-title" data-en="Core Operations" data-es="Operaciones Principales">Core Operations</h2>
                <ul class="article-list">
                    <li><a href="#/kb/users-management" class="article-link" data-en="Users Management" data-es="Gestión de Usuarios">Users Management</a></li>
                    <li><a href="#/kb/crews-management" class="article-link" data-en="Crews Management" data-es="Gestión de Equipos">Crews Management</a></li>
                    <li><a href="#/kb/jobs-management" class="article-link" data-en="Jobs Management" data-es="Gestión de Trabajos">Jobs Management</a></li>
                    <li><a href="#/kb/availability-management" class="article-link" data-en="Availability Management" data-es="Gestión de Disponibilidad">Availability Management</a></li>
                </ul>
            </div>

            <!-- Customer Management -->
            <div class="category-section">
                <h2 class="category-title" data-en="Customer Management" data-es="Gestión de Clientes">Customer Management</h2>
                <ul class="article-list">
                    <li><a href="#/kb/clients-management" class="article-link" data-en="Clients Management" data-es="Gestión de Clientes">Clients Management</a></li>
                    <li><a href="#/kb/estimates" class="article-link" data-en="Estimates" data-es="Presupuestos">Estimates</a></li>
                    <li><a href="#/kb/invoices" class="article-link" data-en="Invoices" data-es="Facturas">Invoices</a></li>
                </ul>
            </div>

            <!-- Services & Products -->
            <div class="category-section">
                <h2 class="category-title" data-en="Services & Products" data-es="Servicios y Productos">Services & Products</h2>
                <ul class="article-list">
                    <li><a href="#/kb/services-catalog" class="article-link" data-en="Services Catalog" data-es="Catálogo de Servicios">Services Catalog</a></li>
                    <li><a href="#/kb/products-catalog" class="article-link" data-en="Products Catalog" data-es="Catálogo de Productos">Products Catalog</a></li>
                </ul>
            </div>

            <!-- Reports & Analytics -->
            <div class="category-section">
                <h2 class="category-title" data-en="Reports & Analytics" data-es="Informes y Análisis">Reports & Analytics</h2>
                <ul class="article-list">
                    <li><a href="#/kb/reports-overview" class="article-link" data-en="Reports Overview" data-es="Resumen de Informes">Reports Overview</a></li>
                    <li><a href="#/kb/work-order-reports" class="article-link" data-en="Work Order Reports" data-es="Informes de Órdenes de Trabajo">Work Order Reports</a></li>
                    <li><a href="#/kb/technician-performance" class="article-link" data-en="Technician Performance" data-es="Rendimiento de Técnicos">Technician Performance</a></li>
                    <li><a href="#/kb/customer-reports" class="article-link" data-en="Customer Reports" data-es="Informes de Clientes">Customer Reports</a></li>
                </ul>
            </div>

            <!-- Financial Reports -->
            <div class="category-section">
                <h2 class="category-title" data-en="Financial Reports" data-es="Informes Financieros">Financial Reports</h2>
                <ul class="article-list">
                    <li><a href="#/kb/financial-reports" class="article-link" data-en="Financial Reports" data-es="Informes Financieros">Financial Reports</a></li>
                    <li><a href="#/kb/time-labor-report" class="article-link" data-en="Time and Labor Report" data-es="Informe de Tiempo y Mano de Obra">Time and Labor Report</a></li>
                </ul>
            </div>

            <!-- Operations & Compliance -->
            <div class="category-section">
                <h2 class="category-title" data-en="Operations & Compliance" data-es="Operaciones y Cumplimiento">Operations & Compliance</h2>
                <ul class="article-list">
                    <li><a href="#/kb/scheduling-dispatch-reports" class="article-link" data-en="Scheduling & Dispatch Reports" data-es="Informes de Programación y Despacho">Scheduling & Dispatch Reports</a></li>
                    <li><a href="#/kb/compliance-safety-reports" class="article-link" data-en="Compliance and Safety Reports" data-es="Informes de Cumplimiento y Seguridad">Compliance and Safety Reports</a></li>
                </ul>
            </div>
        </div>

        <footer>
            <p id="copyright">&copy; 2025 Direct Home Service. All rights reserved.</p>
            <p id="supportText">Need help? <a href="mailto:support@directhomeservice.com" style="color: #2E3192;">Contact Support</a></p>
        </footer>
    </div>

    <!-- Load search engine and UI components -->
    <script src="/js/language-manager.js"></script>
    <script src="/js/search-engine.js"></script>
    <script src="/js/search-ui.js"></script>
    
    <script>
        // Initialize search functionality when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Wait for search engine to load
            const initializeSearch = () => {
                if (!window.dhsSearch || !window.dhsSearchUI) {
                    setTimeout(initializeSearch, 100);
                    return;
                }
                
                // Initialize local search
                const localSearchContainer = document.getElementById('localSearchContainer');
                const localSearchResults = document.getElementById('localSearchResults');
                
                // Create local search box with suggestions and filters
                const localSearchBox = window.dhsSearchUI.createSearchBox(localSearchContainer, {
                    showSuggestions: true,
                    showFilters: false,
                    onSearch: (query, results) => {
                        window.dhsSearchUI.displayResults(query, results, localSearchResults);
                    }
                });
                
                // Create results container with filters
                window.dhsSearchUI.createResultsContainer(localSearchResults, {
                    showFilters: true,
                    showResultsCount: true
                });
                
                // Setup search mode switching
                setupSearchModes();
                
                // Setup external search functionality
                setupExternalSearch();
                
                // Hide loading overlay
                setTimeout(() => {
                    document.getElementById('loadingOverlay').classList.add('hidden');
                }, 300);
            };
            
            initializeSearch();
        });
        
        // Setup search mode switching
        function setupSearchModes() {
            const searchTabs = document.querySelectorAll('.search-tab');
            const searchModes = document.querySelectorAll('.search-mode-container');
            
            searchTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const mode = tab.dataset.searchMode;
                    
                    // Update tab states
                    searchTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Update mode visibility
                    searchModes.forEach(m => m.classList.remove('active'));
                    document.getElementById(mode + 'SearchMode').classList.add('active');
                });
            });
        }
        
        // Setup external search functionality (preserved from original)
        function setupExternalSearch() {
            const searchBox = document.getElementById('externalSearchBox');
            const clearBtn = document.getElementById('externalClearBtn');
            
            if (!searchBox || !clearBtn) return;
            
            // Show/hide clear button based on input
            searchBox.addEventListener('input', function() {
                if (this.value.length > 0) {
                    clearBtn.style.display = 'block';
                } else {
                    clearBtn.style.display = 'none';
                }
            });
            
            // Clear search when clear button is clicked
            clearBtn.addEventListener('click', function() {
                searchBox.value = '';
                clearBtn.style.display = 'none';
                searchBox.focus();
            });
            
            // Add visual feedback for the search form
            searchBox.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    // Form will submit naturally
                    this.style.borderColor = '#2E3192';
                }
            });
        }
        
        // Language switcher functionality
        const languageSwitcher = document.getElementById('languageSwitcher');
        const languageDropdown = document.getElementById('languageDropdown');
        const languageCurrent = document.getElementById('languageCurrent');
        const currentFlag = document.getElementById('currentFlag');
        const currentLang = document.getElementById('currentLang');
        
        // Toggle dropdown - hide current language display when showing options
        languageSwitcher?.addEventListener('click', (e) => {
            e.stopPropagation();
            const isShowing = languageDropdown?.classList.contains('show');
            
            if (!isShowing) {
                // Show dropdown, hide current
                languageDropdown?.classList.add('show');
                languageCurrent?.classList.add('hidden');
                languageSwitcher?.classList.add('selecting');
            } else {
                // Hide dropdown, show current
                languageDropdown?.classList.remove('show');
                languageCurrent?.classList.remove('hidden');
                languageSwitcher?.classList.remove('selecting');
            }
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', () => {
            languageDropdown?.classList.remove('show');
            languageCurrent?.classList.remove('hidden');
            languageSwitcher?.classList.remove('selecting');
        });
        
        // Handle language selection
        document.querySelectorAll('.language-option').forEach(option => {
            option.addEventListener('click', (e) => {
                e.stopPropagation();
                const lang = option.dataset.language;
                
                // Update current display
                if (lang === 'es') {
                    currentFlag.className = 'flag flag-es';
                    currentLang.textContent = 'Español';
                } else {
                    currentFlag.className = 'flag flag-us';
                    currentLang.textContent = 'English';
                }
                
                // Save preference
                localStorage.setItem('dhs-preferred-language', lang);
                
                // Update page content
                updateLanguageContent(lang);
                
                // Hide dropdown, show current
                languageDropdown?.classList.remove('show');
                languageCurrent?.classList.remove('hidden');
                languageSwitcher?.classList.remove('selecting');
            });
        });
        
        // Set initial language
        const savedLang = localStorage.getItem('dhs-preferred-language') || 'en';
        if (savedLang === 'es') {
            currentFlag.className = 'flag flag-es';
            currentLang.textContent = 'Español';
            updateLanguageContent('es');
        }
    </script>
</body>
</html>